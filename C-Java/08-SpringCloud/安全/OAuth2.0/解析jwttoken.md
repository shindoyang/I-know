```java
package com.ut.user.utils;

import com.alibaba.fastjson.JSONArray;
import com.alibaba.fastjson.JSONObject;
import com.ut.user.exception.UtExceptionEnum;
import com.ut.user.exception.UtRuntimeException;
import org.springframework.security.jwt.JwtHelper;

import java.util.HashMap;
import java.util.Map;

/**
 * jwt token 工具类
 */
public class JwtUtil {

	/**
	 * jwt token 反base64
	 */
	public static Object decodeToken(String token) {
		try {
			Map<String, String> header = new HashMap<>();
			Map<String, String> headers = JwtHelper.headers(token);
			headers.entrySet().stream().forEach(entry -> {
				header.put(entry.getKey(), entry.getValue());
			});
			Map<String, Object> result = new HashMap<>();
			result.put("PAYLOAD", JSONObject.parse(JwtHelper.decode(token).getClaims()));
			result.put("HEADER", header);
			return JSONObject.toJSON(result);
		} catch (Exception e) {
			throw new UtRuntimeException(UtExceptionEnum.TOKEN_FORMAT_ERROR);
		}
	}

	public static void main(String[] args) {
		String jwtAccessToken = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX25hbWUiOiJwbGF0Zm9ybV9hZG1pbiIsInNjb3BlIjpbInJlYWQiXSwiZXhwIjoxNjA5NTczMjA2LCJhY2NvdW50U3lzdGVtS2V5IjoiZGVmYXQiLCJhdXRob3JpdGllcyI6WyJkZXZlbG9wZXJfZGV2ZWxvcGVyX21pZGRsZV9maWVsZF9tb2RlbCIsInBsYXRmb3JtX2FwcF9hZGRBcHAiLCJwbGF0Zm9ybV9hY2NvdW50X2dldEFsbFVzZXJuYW1lQnlBdXRob3JpdHkiLCJwbGF0Zm9ybV9hcHBfZGVsZXRlTWVudSIsInBsYXRmb3JtX3VzZXIiLCJkZXZlbG9wZXJfcGxhdGZvcm1fYmFzaWNfaW5mbyIsInBsYXRmb3JtX2FwcF9jaGlsZEFjY291bnRNYW5hZ2VtZW50IiwicGxhdGZvcm1fYXBwX2NyZWF0ZUNoaWxkQWNjb3VudCIsInBsYXRmb3JtX3V0bW9kZWxfZmluZF9wcm9wZXJ0eSIsInBsYXRmb3JtX2FwcF9tYW5hZ2VtZW50IiwiaW90YXBwX2RldmljZV9hZG1pbl9vcGVyYXRlIiwicGxhdGZvcm1fYWNjb3VudF9jcmVhdGVBY2NvdW50U3lzdGVtIiwiZGV2ZWxvcGVyX3NldHRsZW1lbnRfY2xvdWRfdHJhZGUiLCJwbGF0Zm9ybV91dG1vZGVsX2ZpbmRfcHJvZmlsZSIsImRldmVsb3Blcl9wbGF0Zm9ybV9zZWN1cml0eV9zZXR0aW5nIiwiZGV2ZWxvcGVyX2FjY291bnRfc3lzdGVtX2xpc3QiLCJwbGF0Zm9ybV91dG1vZGVsX2xpc3RfcHJvZmlsZSIsInBsYXRmb3JtX2FwcF9iaW5kQXV0aDJVc2VyIiwicGxhdGZvcm1fdXNlcl9jcmVhdFJhbmRvbUNoaWxkIiwicGxhdGZvcm1fYXBwIiwiZGV2ZWxvcGVyX3NldHRsZW1lbnRfc2hhcmVfcHJvZml0IiwicGxhdGZvcm1fdXRtb2RlbF9wcm9wZXJ0eW1hbmFnZXIiLCJsaW5nX2FkZCIsInBsYXRmb3JtX2FwcF9nZXRBcHAiLCJwbGF0Zm9ybV9hcHBfYmluZEF1dGhHcm91cDJVc2VyIiwicGxhdGZvcm1fYXBwX2VtcG93ZXJNYW5hZ2VtZW50IiwiZGV2ZWxvcGVyX0lvVF9wcm9kdWN0X2RldiIsInBsYXRmb3JtX2FwcF9hdXRob3JpdHlNYW5hZ2VtZW50IiwicGxhdGZvcm1fYWNjb3VudF91cGRhdGVBY2NvdW50U3lzdGVtU3RhdHVzIiwiZGV2ZWxvcGVyX3BsYXRmb3JtX3NlbGZfbWVudV9tYW5hZ2VtZW50IiwicGxhdGZvcm1fdXRtb2RlbF91cGRhdGVfcHJvcGVydHkiLCJkZXZlbG9wZXJfc2hvd19wbGF0Zm9ybSIsImlvdGFwcF9lZGdlX2RldmVsb3Blcl9vcGVyYXRlIiwicGxhdGZvcm1fdXRtb2RlbF9xdWVyeV9wcm9wZXJ0eSIsInBsYXRmb3JtX21hbmFnZW1lbnQiLCJwbGF0Zm9ybV9wYWdlUGxhdGZvcm1BcHBzIiwicGxhdGZvcm1fdXRtb2RlbF9ldmVudG1hbmFnZXIiLCJwbGF0Zm9ybV91dG1vZGVsX2ltcG9ydF9wcm9maWxlIiwiZGV2ZWxvcGVyX2RldmVsb3Blcl9taWRkbGVfYnVzaW5lc3NfYW5hbHlzaXMiLCJkZXZlbG9wZXJfcGxhdGZvcm1fY2hhcmFjdG9yX21hbmFnZW1lbnQiLCJwbGF0Zm9ybV91dG1vZGVsX3Byb2ZpbGVtYW5hZ2VyIiwicGxhdGZvcm1fYWNjb3VudF9zeXN0ZW1LZXkiLCJwbGF0Zm9ybV91dG1vZGVsX2ZpbmRfZXZlbnQiLCJwbGF0Zm9ybV9hcHBfYWRkQXV0aG9yaXR5R3JvdXAiLCJwbGF0Zm9ybV9hcHBfYWxsQXBwcyIsInBsYXRmb3JtX3V0bW9kZWxfdXBkYXRlX3NlcnZpY2UiLCJkZXZlbG9wZXJfcGxhdGZvcm1fc2VsZl9mdW5jdGlvbl9tYW5hZ2VtZW50IiwicGxhdGZvcm1fYWNjb3VudF9xdWVyeVVzZXJCeUF1dGhHcm91cCIsInBsYXRmb3JtX2FwcF9tZW51TWFuYWdlbWVudCIsInBsYXRmb3JtX3VzZXJfZ2V0VG9rZW4iLCJkZXZlbG9wZXJfcGxhdGZvcm1fc2VsZl9hdXRob3JpdHlfbWFuYWdlbWVudCIsInBsYXRmb3JtX2FwcF9hbGxBdXRob3JpdGllcyIsInBsYXRmb3JtX3V0bW9kZWxfY3JlYXRlX3NlcnZpY2UiLCJwbGF0Zm9ybV91c2VyX2JhdGNoUmVnaXN0ZXIiLCJwbGF0Zm9ybV91dG1vZGVsX3VwZGF0ZV9wcm9maWxlIiwicGxhdGZvcm1fYXBwX2JpbmRBdXRoMkF1dGhHcm91cCIsImRldmVsb3Blcl9wbGF0Zm9ybV9hY2NvdW50X2JpbmQiLCJwbGF0Zm9ybV9saXN0UGxhdGZvcm1BcHBzIiwiaW90YXBwX3Byb2R1Y3RfZGV2ZWxvcGVyIiwicGxhdGZvcm1fdXRtb2RlbF91cGRhdGVfZXZlbnQiLCJwbGF0Zm9ybV91dG1vZGVsX3NldF9wcm9maWxlX3RhZ3MiLCJwbGF0Zm9ybV91c2VyX2NyZWF0ZVNwZWNpZmllZENoaWxkIiwicGxhdGZvcm1fYWNjb3VudF9nZXRBbGxVc2VybmFtZUJ5QXV0aG9yaXR5R3JvdXAiLCJwbGF0Zm9ybV9hdXRob3JpdHkiLCJpb3RhcHBfcHJvZHVjdF9hZG1pbiIsInBsYXRmb3JtX3VzZXJfbGlzdFVzZXJzIiwicGxhdGZvcm1fYXBwX2JpbmRBdXRoR3JvdXAyTWVudSIsInBsYXRmb3JtX2FwcF9wYWdlQWxsQXV0aG9yaXRpZXMiLCJkZXZlbG9wZXJfcGxhdGZvcm1fYXV0aG9yaXR5X21hbmFnZW1lbnQiLCJkZXZlbG9wZXJfcGxhdGZvcm1fc2VsZl9jaGFyYWN0b3JfbWFuYWdlbWVudCIsImlvdGFwcF9kZXZpY2VfZGV2ZWxvcGVyX29wZXJhdGUiLCJwbGF0Zm9ybV9hY2NvdW50X3BhZ2VBY2NvdW50U3lzdGVtVXNlcnMiLCJkZXZlbG9wZXJfSW9UX2RldmljZV9kZXYiLCJwbGF0Zm9ybV91dG1vZGVsX2xpc3RfcHJvZmlsZV9ieV9rZXkiLCJwbGF0Zm9ybV91dG1vZGVsX2RlbGV0ZV9wcm9maWxlIiwicGxhdGZvcm1fdXRtb2RlbF9jcmVhdGVfcHJvZmlsZSIsInBsYXRmb3JtX2FwcF9jaGlsZFVzZXJzIiwicGxhdGZvcm1fdXRtb2RlbF9kZWxldGVfZXZlbnQiLCJwbGF0Zm9ybV91c2VyX2xpc3ROdW1iZXIiLCJwbGF0Zm9ybV91dG1vZGVsX3NlcnZpY2VtYW5hZ2VyIiwicGxhdGZvcm1fYWRtaW4iLCJwbGF0Zm9ybV9hcHBfZ2V0TWVudSIsInBsYXRmb3JtX3VzZXJfY2hlY2tBbmRSZWdpc3RlciIsInBsYXRmb3JtX3V0bW9kZWxfbGlzdF9wcm9wZXJ0eSIsInBsYXRmb3JtX21lbnUiLCJwbGF0Zm9ybV91dG1vZGVsX2NyZWF0ZV9wcm9wZXJ0eSIsInBsYXRmb3JtX2FwcF91cGRhdGVBcHAiLCJwbGF0Zm9ybV9hcHBfYWxsQXV0aG9yaXR5R3JvdXBzIiwicGxhdGZvcm1fYXBwX2JpbmRBdXRoMk1lbnUiLCJwbGF0Zm9ybV9hcHBfZGVsZXRlQXV0aG9yaXR5R3JvdXAiLCJwbGF0Zm9ybV9hcHBfdW5CaW5kQXV0aDJBdXRoR3JvdXAiLCJwbGF0Zm9ybV91dG1vZGVsX3F1ZXJ5X3Byb2ZpbGUiLCJwbGF0Zm9ybV9hcHBfYWRkQXV0aG9yaXR5IiwicGxhdGZvcm1fYXBwX3VwZGF0ZUF1dGhvcml0eUdyb3VwIiwiZGV2ZWxvcGVyX3BsYXRmb3JtX21lbnVfbWFuYWdlbWVudCIsInBsYXRmb3JtX2FjY291bnRfY3JlYXRVc2VyVW5kZXJBY2NvdW50IiwiaW90YXBwX2VkZ2VfYWRtaW5fb3BlcmF0ZSIsImlvdGFwcF9kcml2ZXJfYWRtaW5fb3BlcmF0ZSIsInBsYXRmb3JtX3V0bW9kZWxfcXVlcnlfc2VydmljZSIsInBsYXRmb3JtX3V0bW9kZWxfZXhwb3J0X3Byb2ZpbGUiLCJwbGF0Zm9ybV9hcHBfZGVsZXRlQXV0aG9yaXR5IiwiZGV2ZWxvcGVyX3BsYXRmb3JtX3NlbGZfYXBwX2xpc3QiLCJwbGF0Zm9ybV9hY2NvdW50X3VwZGF0ZVVzZXJTdGF0dXMiLCJwbGF0Zm9ybV9hcHBfYWRkTWVudSIsImRldmVsb3Blcl9wbGF0Zm9ybV9hcHBfbGlzdCIsInBsYXRmb3JtX3V0bW9kZWxfZmluZF9zZXJ2aWNlIiwicGxhdGZvcm1fYWNjb3VudF91cGRhdGVVc2VyIiwicGxhdGZvcm1fdXRtb2RlbF9saXN0X3NlcnZpY2UiLCJkZXZlbG9wZXJfc2V0dGxlbWVudF9jbG91ZF9jb25maWciLCJwbGF0Zm9ybV9hY2NvdW50X3BhZ2VBY2NvdW50U3lzdGVtcyIsImVudGVycHJpc2VfZGV2ZWxvcF9vcGVyYXRlIiwiZGV2ZWxvcGVyX3BsYXRmb3JtX3N1Yl9hY2NvdW50X21hbmFnZW1lbnQiLCJwbGF0Zm9ybV9hcHBfYWxsTWVudXMiLCJwbGF0Zm9ybV9yZXNldFB3ZCIsInBsYXRmb3JtX3V0bW9kZWxfbGlzdF9ldmVudCIsImRldmVsb3Blcl9kZXZlbG9wZXJfbWlkZGxlX3Byb2Nlc3NfZ3VpZGFuY2UiLCJpb3RhcHBfcmVfZGV2ZWxvcGVyIiwiaW90YXBwX2RyaXZlcl9kZXZlbG9wZXJfb3BlcmF0ZSIsInBsYXRmb3JtX2FwcF9hcHBMaXN0IiwiZGV2ZWxvcGVyX3NlcnZpY2VfY3VzdG9taXphdGlvbl9ob21lIiwicGxhdGZvcm1fYWNjb3VudF91cGRhdGVBY2NvdW50U3lzdGVtIiwicGxhdGZvcm1fYXV0aG9yaXR5R3JvdXAiLCJwbGF0Zm9ybV91dG1vZGVsX2RlbGV0ZV9wcm9wZXJ0eSIsInBsYXRmb3JtX3V0bW9kZWxfY3JlYXRlX2V2ZW50IiwiZGV2ZWxvcGVyX3BsYXRmb3JtX2Z1bmN0aW9uX21hbmFnZW1lbnQiLCJwbGF0Zm9ybV9hY2NvdW50X2NyZWF0VXNlciIsInBsYXRmb3JtX2FwcF91cGRhdGVBdXRob3JpdHkiLCJwbGF0Zm9ybV91dG1vZGVsX2RlbGV0ZV9zZXJ2aWNlIiwicGxhdGZvcm1fYXBwX3VuQmluZEF1dGgyTWVudSIsInBsYXRmb3JtX3V0bW9kZWxfcXVlcnlfZXZlbnQiLCJwbGF0Zm9ybV9hcHBfYXV0aG9yaXR5R3JvdXBNYW5hZ2VtZW50IiwicGxhdGZvcm1fYXBwX2NoYW5nZUFwcFN0YXR1cyIsInBsYXRmb3JtX2FwcF91bkJpbmRBdXRoR3JvdXAyTWVudSIsInBsYXRmb3JtX2FwcF91cGRhdGVNZW51IiwicGxhdGZvcm1fdG1vZGVsX3VwZGF0ZV9wcm9wZXJ0eSJdLCJqdGkiOiJkZjQxZTA3OC0wN2Q0LTQ1ZWEtOGJmZC1lYTVkNTUyYmJhNmEiLCJjbGllbnRfaWQiOiJzc28tZ2F0ZXdheSIsInVzZXJuYW1lIjoicGxhdGZvcm1fYWRtaW4ifQ.FWBTqXU9TNsrV9NbZb35M_-P1i8E__-XjgQ99lanJQw";
		JSONObject o = (JSONObject) JwtUtil.decodeToken(jwtAccessToken);
		JSONObject payload = (JSONObject) o.get("PAYLOAD");
		JSONArray authorities = (JSONArray) payload.get("authorities");
		System.out.println(authorities.size());
	}
}

```

