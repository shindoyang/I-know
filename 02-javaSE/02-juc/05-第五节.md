

### AQS源码 =  volatile + cas

#### 两个核心

1. state：记录线程重入了多少次 volatile修饰
2. node：线程节点=双向链表（需要看前面节点的状态） cas

添加线程到对接尾巴：compareAndSetTail  
优点：用cas操作尾巴节点，替代锁整条链表的操作，所以性能高

VarHandle：jdk1.9之后才有的。  --addWaiter方法里面。 指向某个变量的引用。 强引用
var变量，handle句柄

* varHandle -> 1：普通属性原子操作 2：比反射快，直接操作二进制码



